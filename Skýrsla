Lokaverkefni

IoT box

The idea was that we are gonna do a Iot box with change able profiles by rotating the box around. For example by default It would run time with some image/gif 
on it by rotating it by 90° gyro would pick up the directions that a user made and on this basis would change a profile. Profiles supossed to be at least 3.
first with time, secound with weather and third with some kind of a stop watch. The problems started with finding a examples/tutroials on how to operate
matrix panel with python codes, all I found was done librarys which wasnt easly custob. This led to being stuck for a while with the project.
Rafal started with just trying to panel display anything meanhwile ---- started working with gyro. After making panel to work we notices that there was problem
that panel did not display all leds which led me to looking for an answer in code. The reason it didnt wotk was because Bonnet wasnt soldered properly
so we hadto change it. By the time we got something to work we had 2h left so we ened up just doing simple profile with time and weather without gyro.




3D prentun
With 3D box we tried to have it as clean as possible, meaning no wires or visible screws. Because of that box had to be a little bigger than panel itself
with room for cables, raspberry and batteries and gyro. It turned out fine, the only issue was attaching everything inside. Box took itself around 15h of printing
so we did not having time for experimenting with it. We assumed that simple tape gonna make the work done. Everything turned out tight without even
needing screws for panel( which i made a small/hink walls to hold panne with screws that are not visible).





Kóði sem birtast tíma og hitaspá

from samplebase import SampleBase
from rgbmatrix import graphics
from datetime import datetime
import time, requests

def getWeatherApi(city = "Keflavik", key = "ec287ad7a92b087d609e988f0b9dee8a"):
    base_url = "http://api.openweathermap.org/data/2.5/weather?"
    complete_url = base_url + "appid=" + key + "&q=" + city
    request = requests.get(complete_url)
    return request.json()

def getTemp(jsn):
    weather = jsn['main']
    current_temperature = weather["temp"]
    return int(current_temperature-273.15)
    
class RunText(SampleBase):
    def __init__(self, *args, **kwargs):
        super(RunText, self).__init__(*args, **kwargs)
        
        def run(self):
            offscreen_canvas = self.matrix.CreateFrameCanvas()
            font = graphics.Font()
            font.LoadFont("../../../fonts/10x20.bdf")
            textColor = graphics.Color(64, 96, 128)
            counter = 800
            while True:
                kl = datetime.now()
                kl = kl.strftime("%H:%M")
                offscreen_canvas.Clear()
                if counter == 800:
                    response = getWeatherApi()
                    counter = 0
                    temp = str(getTemp(response))+"°C"
                    len = graphics.DrawText(offscreen_canvas, font, 7, 21, textColor, kl)
                    len = graphics.DrawText(offscreen_canvas, font, 17, 53, textColor, temp)
                    time.sleep(0.05)
                    counter += 1
                    offscreen_canvas = self.matrix.SwapOnVSync(offscreen_canvas)
                    
# Main function
if __name__ == "__main__":
    run_text = RunText()
    if (not run_text.process()):
        run_text.print_help()


